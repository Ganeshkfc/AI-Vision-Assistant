- name: Build APK with Buildozer
  run: |
          export PATH=$PATH:~/.local/bin
          
          # SAFETY CHECK: Only clean if the platform folder exists.
          # This prevents the 'FileNotFoundError' on fresh GitHub runs.
          if [ -d ".buildozer/android/platform/python-for-android" ]; then
            buildozer android clean
          else
            echo "Fresh build environment detected, skipping clean step."
          fi
          
          # Start the actual build
          yes | buildozer -v android debug
        env:
          BUILDOZER_ALLOW_ORG_NAME_AS_PACKAGE_NAME: 1
